# Sistema de InternacionalizaciÃ³n (i18n)

TravelMap ahora soporta mÃºltiples idiomas. Este documento explica cÃ³mo funciona el sistema y cÃ³mo agregar o modificar traducciones.

## Arquitectura

El sistema i18n utiliza archivos JSON separados para cada idioma:

```
lang/
  â”œâ”€â”€ en.json    (InglÃ©s - idioma por defecto)
  â””â”€â”€ es.json    (EspaÃ±ol)
```

### PHP (Backend)

- **Clase**: `src/helpers/Language.php`
- **FunciÃ³n helper**: `__($key, $default)`
- **Ejemplo de uso**:
  ```php
  echo __('app.title');  // Output: "Travel Map - My Travels Around the World"
  echo __('navigation.home');  // Output: "Home"
  ```

### JavaScript (Frontend)

- **Archivo**: `assets/js/i18n.js`
- **FunciÃ³n helper**: `__($key, $defaultValue)`
- **Ejemplo de uso**:
  ```javascript
  const title = __('map.my_trips');  // Output: "My Trips"
  const search = __('map.search_button');  // Output: "Search"
  ```

## Estructura de Archivos de Idioma

Los archivos JSON estÃ¡n organizados jerÃ¡rquicamente por secciones:

```json
{
  "app": {
    "name": "TravelMap",
    "title": "Travel Map - My Travels Around the World"
  },
  "navigation": {
    "home": "Home",
    "trips": "Trips",
    "points": "Points of Interest"
  },
  "map": {
    "my_trips": "My Trips",
    "routes": "Routes",
    "points": "Points"
  }
}
```

### Acceso a las Traducciones

Use notaciÃ³n de punto para acceder a valores anidados:

- `app.name` â†’ "TravelMap"
- `navigation.home` â†’ "Home"
- `map.my_trips` â†’ "My Trips"

## Agregar un Nuevo Idioma

1. **Crear el archivo JSON**:
   ```bash
   cp lang/en.json lang/fr.json
   ```

2. **Traducir todas las cadenas** en el nuevo archivo

3. **Actualizar los archivos del sistema**:

   En `src/helpers/Language.php`:
   ```php
   private $availableLanguages = ['en', 'es', 'fr'];  // Agregar 'fr'
   
   public function getLanguageName($langCode) {
       $names = [
           'en' => 'English',
           'es' => 'EspaÃ±ol',
           'fr' => 'FranÃ§ais'  // Agregar
       ];
       return $names[$langCode] ?? $langCode;
   }
   ```

   En `assets/js/i18n.js`:
   ```javascript
   availableLanguages: ['en', 'es', 'fr'],  // Agregar 'fr'
   
   getLanguageName: function(langCode) {
       const names = {
           'en': 'English',
           'es': 'EspaÃ±ol',
           'fr': 'FranÃ§ais'  // Agregar
       };
       return names[langCode] || langCode;
   }
   ```

4. **Actualizar el selector de idioma** en `index.php`:
   ```php
   <select id="languageSelector" class="form-select form-select-sm">
       <option value="en">ğŸ‡¬ğŸ‡§ English</option>
       <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
       <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>  <!-- Agregar -->
   </select>
   ```

5. **Actualizar la configuraciÃ³n de idiomas** en `admin/settings.php`:
   ```php
   $languages = [
       'en' => 'English',
       'es' => 'EspaÃ±ol',
       'fr' => 'FranÃ§ais'  // Agregar
   ];
   ```

## Agregar Nuevas Traducciones

Cuando agregues nueva funcionalidad que incluya texto visible:

1. **Nunca escribas texto hardcodeado**. Siempre usa el sistema i18n.

2. **Agrega la traducciÃ³n en TODOS los archivos de idioma**:

   En `lang/en.json`:
   ```json
   {
     "points": {
       "new_feature": "New Feature Text"
     }
   }
   ```

   En `lang/es.json`:
   ```json
   {
     "points": {
       "new_feature": "Texto de Nueva Funcionalidad"
     }
   }
   ```

3. **Usa la funciÃ³n helper apropiada**:

   PHP:
   ```php
   <button><?= __('points.new_feature') ?></button>
   ```

   JavaScript:
   ```javascript
   const text = __('points.new_feature');
   ```

## DetecciÃ³n de Idioma

El sistema detecta el idioma en el siguiente orden de prioridad:

### PHP (Backend)
1. ParÃ¡metro GET `?lang=en`
2. Cookie `travelmap_lang`
3. ConfiguraciÃ³n del sistema (base de datos)
4. Idioma del navegador (`Accept-Language`)
5. Idioma por defecto (inglÃ©s)

### JavaScript (Frontend)
1. localStorage `travelmap_lang`
2. Cookie `travelmap_lang`
3. Idioma del navegador
4. Idioma por defecto (inglÃ©s)

## Cambiar el Idioma

### Como Usuario

Los usuarios pueden cambiar el idioma desde:
- **Frontend**: Selector de idioma en el panel lateral del mapa
- **ConfiguraciÃ³n**: El administrador puede establecer el idioma por defecto del sitio

### Como Administrador

1. Ir a **Admin â†’ ConfiguraciÃ³n**
2. En la secciÃ³n "ConfiguraciÃ³n General", seleccionar el idioma por defecto
3. Guardar cambios

Este idioma serÃ¡ el predeterminado para nuevos visitantes.

## Mejores PrÃ¡cticas

### âœ… Hacer

- Usar claves descriptivas: `trips.confirm_delete` en lugar de `msg1`
- Agrupar traducciones relacionadas bajo la misma secciÃ³n
- Mantener consistencia en las traducciones
- Agregar traducciones en todos los idiomas soportados
- Usar valores por defecto razonables en las funciones helper

### âŒ Evitar

- Texto hardcodeado en cÃ³digo PHP o JavaScript
- Claves genÃ©ricas o poco descriptivas
- Dejar traducciones vacÃ­as
- Duplicar traducciones (usar referencias cuando sea posible)
- Mezclar idiomas en el mismo archivo

## Ejemplo Completo

### Agregar un nuevo mensaje de confirmaciÃ³n

1. **Agregar en `lang/en.json`**:
```json
{
  "trips": {
    "confirm_archive": "Are you sure you want to archive this trip?"
  }
}
```

2. **Agregar en `lang/es.json`**:
```json
{
  "trips": {
    "confirm_archive": "Â¿EstÃ¡s seguro de que deseas archivar este viaje?"
  }
}
```

3. **Usar en PHP**:
```php
<button onclick="if(confirm('<?= __('trips.confirm_archive') ?>')) archiveTrip()">
    Archive
</button>
```

4. **Usar en JavaScript**:
```javascript
if (confirm(__('trips.confirm_archive'))) {
    archiveTrip();
}
```

## Testing

Para probar las traducciones:

1. **Cambiar idioma temporalmente**: Agregar `?lang=es` a la URL
2. **Verificar localStorage**: Usar DevTools â†’ Application â†’ Local Storage
3. **Verificar cookies**: Usar DevTools â†’ Application â†’ Cookies
4. **Probar todos los idiomas** antes de hacer commit

## Contribuir

Si encuentras:
- Texto sin traducir
- Traducciones incorrectas
- Problemas con el cambio de idioma

Por favor abre un issue o pull request en GitHub.

### Checklist para Pull Requests

- [ ] AgreguÃ© traducciones en TODOS los idiomas soportados
- [ ] Las claves son descriptivas y estÃ¡n organizadas lÃ³gicamente
- [ ] ProbÃ© el cambio de idioma en el frontend
- [ ] No hay texto hardcodeado en mi cÃ³digo
- [ ] Las traducciones son culturalmente apropiadas

---

**Idiomas actualmente soportados:**
- ğŸ‡¬ğŸ‡§ InglÃ©s (en) - Idioma por defecto
- ğŸ‡ªğŸ‡¸ EspaÃ±ol (es)

**Â¿Quieres agregar un idioma?** Â¡Las contribuciones son bienvenidas! Revisa la secciÃ³n "Agregar un Nuevo Idioma" arriba.
